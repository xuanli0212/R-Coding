#Create the table dataframe of sample size, power,delta and alpha
s<-c(5452,4627,3972,3278,2268,4827,3870,3273,2846,1748,3972,3273,2726,2157,1355,3278,2846,2157,1655,964,2268,1748,1355,964,459,1370,1163,998,824,570,1163,973,823,665,440,998,823,685,542,341,824,685,542,416,243,570,440,341,243,116,614,521,448,370,256,521,436,369,298,197,448,369,307,243,153,370,298,243,187,109,256,197,153,109,52,350,297,255,211,148,297,248,210,170,112,255,210,175,139,87,211,170,139,106,62,146,112,87,62,30,227,193,166,137,95,193,162,137,111,73,166,137,114,90,57,137,111,90,69,41,95,73,57,41,20,161,137,117,97,67,137,114,97,76,52,117,97,81,64,40,97,78,64,19,29,67,52,40,29,14,121,103,88,73,51,103,86,73,59,39,88,73,61,48,30,73,59,48,37,22,51,39,30,22,11,96,81,69,57,40,81,68,57,46,31,69,57,48,38,24,57,46,38,29,17,40,31,24,17,8,77,66,58,47,32,65,55,46,38,25,56,48,39,31,20,47,38,31,24,14,32,25,20,14,7,64,55,47,39,27,55,46,39,32,21,47,39,32,26,16,39,32,25,20,12,27,21,16,12,6,55,47,40,33,23,47,39,33,27,18,40,33,28,22,14,33,27,22,17,10,23,18,14,10,5,48,41,35,29,20,41,34,29,24,16,35,29,24,19,12,29,24,19,15,9,20,16,12,9,4,43,36,31,26,18,36,30,26,21,14,31,26,22,17,11,26,21,17,13,8,18,14,11,8,4,38,32,28,23,16,32,27,23,19,13,28,23,19,15,10,23,19,15,12,7,16,13,10,7,4,35,30,25,21,15,30,25,21,17,11,25,21,18,14,9,21,17,14,11,7,15,11,9,7,3,32,27,23,19,14,27,23,19,16,11,23,19,16,13,8,19,16,13,10,6,14,11,8,6,3,30,25,22,18,13,25,21,18,15,10,22,18,15,12,8,18,15,12,9,6,13,10,8,6,3,28,24,20,17,12,24,20,17,14,9,20,17,14,11,7,17,14,11,9,5,12,9,7,5,3,26,22,19,15,11,22,19,16,13,9,19,16,13,11,7,16,13,11,8,5,11,9,7,5,3,25,21,18,15,11,21,18,15,12,8,18,15,13,10,7,15,12,10,8,5,11,8,7,5,3,22,19,16,14,10,19,16,14,11,8,16,14,11,9,6,14,11,9,7,4,10,8,6,4,2,21,18,15,13,9,18,15,13,10,7,15,13,11,9,6,13,10,9,7,4,9,7,6,4,2,20,17,15,12,9,17,14,12,10,7,15,12,10,8,5,12,10,8,6,4,9,7,5,4,2,19,16,14,12,8,16,14,12,10,6,14,12,10,8,5,12,10,8,6,4,8,6,5,4,2,18,16,13,11,8,16,13,11,9,6,13,11,9,8,5,11,9,8,6,4,8,6,5,4,2,18,15,13,11,8,15,13,11,9,6,13,11,9,7,5,11,9,7,6,4,8,6,5,4,2)
d<-c(0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.1,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.3,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.4,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.7,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.8,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,1.9,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.25,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,2.75,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5)
p<-c(0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.975,0.95,0.9,0.75,0.99,0.025,0.05,0.1,0.25)
a<-c(0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25,0.01,0.01,0.01,0.01,0.01,0.025,0.025,0.025,0.025,0.025,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.25,0.25,0.25,0.25,0.25)
table<-data.frame(nvalue=s,deltavalue=d,powervalue=p,alphavalue=a) 
#' Sample test for Gehan
#'  
#'Sample test is used to judge whether there is enough sample for Gehan test
#'@param n list of string.x is the Background Measurements.
#'@param m list of string.y is the Site Measurements.
#'@param alpha   test significance for Gehan Test
#'@param delta  the magnitude of the difference in median site and background that should be detected by Gehan Test
#'@param power  Power value for Gehan Test
#'@examples for guidance example
#'y<-c("2","<4","8","17","20","25","34","<35","40","43")
#'x<-c("1","<4", "5", "7","<12","15","18","<21","<25","27")
#'sampletest(x,y,alpha=0.05,delta=2.0 ,power=0.9)
sampletest<-function(n,m,alpha=0.05,delta=2.0,power=0.9){ 
  #if n=m,then get the sample size value from table 
 if(length(n)==length(m)){
   #read the table sample value
   N=table[table[,"deltavalue"]==delta & table[,"powervalue"]==power& table[,"alphavalue"]==alpha,"nvalue"]
   #if the sample size is larger than table value,sample size is enough
   if(N<=length(n)){
     cat("The samplesize is enough")
   }
   else{
     more=N-length(n)
     warning("The sample size isn't enough,you need " ,more , "more samples")
     }
   }
 #if n is not equal to m,we need increase the table sample size by 20% to test.
 else{
   nmin=min(length(n),length(m))
   N=table[table[,"deltavalue"]==delta & table[,"powervalue"]==power& table[,"alphavalue"]==alpha,"n"]
   if(nmin>=N*1.2){
     cat("The samplesize is enough")
     }
     else{
     more=N*1.2-nmin
      warning("The sample size isn't enough,you need ",more,"more samples")
     }
    }
  
}

#' Gehan test
#'  
#'Gehan test is used to do Gehan Test. Gehan test asks if the site median (MP/I) is larger than the background median (MB/G).
#'@param x list of string.x is the Background Measurements.< can be put to specify less than the observed date.
#'@param y list of string.y is the Site Measurements. < can be put to specify less than the observed date.
#'@param alpha   test significance for Gehan Test
#'@param delta  the magnitude of the difference in median site and background that should be detected by Gehan Test
#'@param power  Power value for Gehan Test
#'@examples for guidance example
#'y<-c("2","<4","8","17","20","25","34","<35","40","43")
#'x<-c("1","<4", "5", "7","<12","15","18","<21","<25","27")
#'Gehan(x,y,alpha=0.05,delta=2.0,power=0.9)
Gehan<-function(x,y,alpha=0.05,delta=2.0,power=0.9){
  #Step 1 Perform sample test  
  sampletest(x,y,alpha,delta,power)
  #Step 2 for N>=10 and M>=10 ,we calculate the G-score  
  if(length(x)>=10&&length(y)>=10){
    N=Gscore(x,y)
  #step 3 we compare G-score to z-score and get conclusion
    Z=qnorm(1-alpha,mean=0,sd=1)
    if(N >= Z){
      cat("\nThe Gscore is",N,"\nThis chemical is a COPC\n")
    }
    else{
      cat("\nThe Gscore is",N,"the evidence is not strong enough to conclude that the chemical is a COPC.\n ")
    }
  }
  #Step 2  N<10 and M<10 is not suitable for this test
  else {
    warning("\nSample size is less than 10. It is not suitable for Gehan test(n>=10)")
  }     
}

#Calculation of gscore
Gscore<-function(x,y){
#construct a dataframe to hold the g-score table information
  a<-data.frame(matrix(ncol = 7, nrow = length(x)))
  b<-data.frame(matrix(ncol = 7, nrow = length(y))) 
  #The first column of matrix is data  
  a[,1]<-x
  b[,1]<-y
#The second column of matrix is h that means whether it is from background(0) or Site(1)
  a[,2]=0
  b[,2]=1
#combine the two matrix 
  X=rbind(a,b)

#The third column is index (whether the data contain"<"), "<" is non-detect data.
  for(i in 1:nrow(X)){
    if(grepl("<",X[i,1])){
      X[i,3]=1
      }
     else{X[i,3]=0}
     }
   #T denote the total number of nondetects
  T=sum(X[,3])
  total<<-T

  # delete the < and turn string to number.
  X[,1]<-as.numeric(gsub("<","", X[,1]))
  #sort X by ascending 
  X <- X[order(X[,1]),] 
  #forth colum is d and fifth column is e
  #If the first datum in column 1 is a detect then set d = 1 and e = 0 in the first row of Table 1. o  
  #If the first datum in column 1 is a nondetect value, then set d = 0 and e = 1 in the first row of Table    
#Column 4vFor each successive row (rows 2 through n = 20), increase d by 1 whenever the datum in column 1 in that row is a detect 
#Column 5 For each successive row, increase eby 1 whenever the datum in column 1 in that row is a nondetect value  
#Calculate R-value as column 6 
#if detect,R= d+(T+e)/2, if nondetect,R= (T+1+d)/2  
for(i in 1:nrow(X)){
    if(i==1)
    {  
      if(X[i,3]==0){
        X[1,4]=1
        X[1,5]=0
        X[i,6]=X[i,4]+(T+X[i,5])/2
      }
      else {
        X[1,4]=0
        X[1,5]=1
        X[i,6]=(T+1+X[i,4])/2
       }
    }

 else {
      if(X[i,3]==0){
        X[i,4]=X[i-1,4]+1
        X[i,5]=X[i-1,5]
        X[i,6]=X[i,4]+(T+X[i,5])/2
      }
      else{
        X[i,5]=X[i-1,5]+1
        X[i,4]=X[i-1,4]
        X[i,6]=(T+1+X[i,4])/2
      }  
    }
#Calculate a(R)=2R-N-1
    X[i,7]=2*X[i,6]-nrow(X)-1 
   }
  
#G=(sum of h*a(R))/(sum of a(R)^2/N(N-1))
  G=(X[,2]%*%X[,7])/((X[,7]%*%X[,7])/(nrow(X)*(nrow(X)-1)))
  G<<-c(G)
  return(G)
}

#'@export
